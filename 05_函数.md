[返回: 目录](00_目录.md)
[跳转:04-数组](04_数组.md)

# 05&ensp;函数

## 05.01&ensp;统计函数

### 05.01.01&ensp;聚合函数

|     | `A` | `B` | `C` |
| --- | --- | --- | --- |
| `1` | 1   | 2   | 3   |
| `2` | 4   | 5   | 6   |
| `3` | 7   | 8   | 9   |

---

| 函数      | 描述                                     | 示例           | 结果        |
| :-------- | :--------------------------------------- | :------------- | :---------- |
| `SUM`     | 对引用的数组、区域、常量数组求和         | SUM(A1:C3)     | 45          |
| `MAX`     | 获取数组、区域、常量数组中的最大值       | MAX(A1:C3)     | 9           |
| `MIN`     | 获取数组、区域、常量数组中的最小值       | MIN(A1:C3)     | 1           |
| `AVERAGE` | 获取数组、区域、常量数组的平均值         | AVERAGE(A1:C3) | 3.5         |
| `COUNT`   | 获取数组、区域、常量数组的数值数量       | COUNT(A1:C3)   | 9           |
| `COUNTA`  | 获取数组、区域、常量数组中非空数值的数量 | COUNTA(A1:C3)  | 9           |
| `STDEV`   | 获取数组、区域、常量数组的标准差         | STDEV(A1:C3)   | 2.738612788 |

### 05.01.02&ensp;条件统计函数

|     | `A`    | `B`      | `C`  |
| --- | ------ | -------- | ---- |
| `1` | 人员   | 时间     | 支出 |
| `2` | 大大只 | 2024/4/1 | 788  |
| `3` | 细细粒 | 2024/4/2 | 169  |
| `4` | 大大只 | 2024/3/1 | 278  |
| `5` | 细细粒 | 2024/3/1 | 923  |
| `6` | 大大只 | 2024/4/5 | 127  |
| `7` | 细细粒 | 2024/3/6 | 666  |

---

---

| 函数                                 | 作用         | 语法                                             | 示例                                                  | 结果 |
| ------------------------------------ | ------------ | ------------------------------------------------ | ----------------------------------------------------- | ---- |
| [ SUMIF ](./xlsx/05.01.02.xlsx)      | 条件求和     | =SUMIF(条件区域,条件,值)                         | =SUMIF(B2:B7,"<"&--"2024/4/1",C2:C7)                  | 13   |
| [ COUNTIF  ](./xlsx/05.01.02.xlsx)   | 条件计数     | =COUNTIF(条件区域,条件)                          | =COUNTIF(A2:A7,"细细粒")                              | 3    |
| [ AVERAGEIF ](./xlsx/05.01.02.xlsx)  | 条件平均值   | =AVERAGEIF(条件区域,条件,值)                     | =AVERAGEIF(A2:A7,"细\*",C2:C7)                        | 4    |
| [ SUMIFS ](./xlsx/05.01.02.xlsx)     | 多条件求和   | =SUMIFS(值区域,条件区域,条件,条件区域,条件…)     | =SUMIFS(C2:C7,A2:A7,"大大只",B2:B7,">"&--"2024/3/31") | 6    |
| [ COUNTIFS ](./xlsx/05.01.02.xlsx)   | 多条件计数   | =COUNTIFS(条件区域,条件,条件区域,条件…)          | =COUNTIFS(A2:A7,"细细?",B2:B7,">="&B5)                | 3    |
| [ AVERAGEIFS ](./xlsx/05.01.02.xlsx) | 多条件平均值 | =AVERAGEIFS(值区域,条件区域,条件,条件区域,条件…) | =AVERAGEIFS(C2:C7,A2:A7,"\*",B2:B7,">"&0)             | 3.5  |
| [ MAXIFS ](./xlsx/05.01.02.xlsx)     | 多条件最大值 | =MAXIFS(值区域,条件区域,条件,条件区域,条件…)     | =MAXIFS(C2:C7,A2:A7,"\*只")                           | 5    |
| [ MINIFS ](./xlsx/05.01.02.xlsx)     | 多条件最小值 | =MINIFS(值区域,条件区域,条件,条件区域,条件…)     | =MINIFS(C2:C7,A2:A7,"细?粒",B2:B7,"<"&TODAY())        | 2    |

## 05.02&ensp;文本函数

### 05.02.01&ensp;截取函数

### 05.02.02&ensp;合并函数

### 05.02.03&ensp;拆分函数

### 05.02.04&ensp;转换函数

## 05.03&ensp;逻辑函数

| 函数    | 描述               | 语法                      | 示例               | 结果  |
| ------- | ------------------ | ------------------------- | ------------------ | ----- |
| `TRUE`  | 返回 TRUE 值       |                           | =TRUE()            | TRUE  |
| `FALSE` | 返回 FALSE 值      |                           | =FALSE()           | FALSE |
| `AND`   | 判断是否都为真值   | (值\\逻辑值,值\\逻辑值..) | =AND(TRUE,1,FALSE) | FALES |
| `OR`    | 判断是否有一个真值 | (值\\逻辑值,值\\逻辑值..) | =OR(TRUE,1,FALSE)  | TRUE  |
| `NOT`   | 取反               | (值\\逻辑值)              | =NOT(1)            | FALSE |
| `XOR`   | 判断是否有一个真值 | (值\\逻辑值,值\\逻辑值..) | =XOR(TRUE,1,FALSE) | FALSE |

### 05.03.01&ensp;IF

> IF(值/逻辑值,真值,假值)

1. 示例 1

```
=IF(1>0,"1大于0","1小于等于0")
结果:1大于0
```

2. 示例 2
   **在 EXCEL 中,非 0 数值都可以视作 TRUE**

```
=IF(1-1,"A","B")
结果:B
```

### 05.03.02&ensp;IFS

IFS(条件 1,值 1,条件 2,值 2...)

> 从条件 1 开始判断，如果条件成立，则返回对应的值，如果条件不成立则进入下一个条件判断，直到找到一个条件为真的值，返回对应的值。
> 如果所有条件都不成立，则返回#N/A

1. 示例 1

```
=IFS(1>3,"A",1>2,"B",1>1,"C",1>0,"D")
结果:D
```

2. 示例 2

```
=IFS(1>3,"A",1>2,"B",1>1,"C")
结果:#N/A
```

### 05.03.03&ensp;SWITCH

SWITCH(数值,数值 1,结果 1,数值 2,结果 2...)

> 转换数值到对应的结果
> 如果没有对应数值，则返回#N/A

1. 示例 1

```
=SWITCH(3,1,"星期一",2,"星期二",3,"星期三")
结果:星期三
```

2. 示例 2

```
=SWITCH(4,1,"星期一",2,"星期二",3,"星期三")
结果:#N/A
```

## 05.04&ensp;错误函数

## 05.05&ensp;随机函数

## 05.06&ensp;查找引用函数

### 05.06.01&ensp;VLOOKUP

### 05.06.02&ensp;HLOOKUP

### 05.06.03&ensp;XLOOKUP

### 05.06.04&ensp;LOOKUP

### 05.06.05&ensp;MATCH

### 05.06.06&ensp;XMATCH

### 05.06.07&ensp;INDEX

### 05.06.08&ensp;OFFSET

### 05.06.09&ensp;INDIRECT

### 05.06.10&ensp;ADDRESS

### 05.06.11&ensp;ROW

### 05.06.12&ensp;COLUMN

### 05.06.13&ensp;ROWS

### 05.06.14&ensp;COLUMNS

## 05.07&ensp;日期时间函数

## 05.08&ensp;数组函数

### 05.08.01&ensp;FILTER

### 05.08.02&ensp;HSTACK

HSTACK(数组/区域/值,数组/区域/值...)
水平拼接数组/区域/值
如果数组的行数少于所选数组的最大宽度，则 Excel 将在其他行中返回 #N/A 错误。

|     | `A` | `B` | `C` | `D` |
| --- | --- | --- | --- | --- |
| `1` | 1   | 2   | 3   | 4   |
| `2` | 5   | 6   | 7   | 8   |

1. 拼接区域

```
=HSTACK(A1:A2,D1:D2)
```

结果:
|||
|-|-|
|1|4|
|5|8|

2. 拼接空数组

```
=HSTACK(A1:A2,"A")
```

结果:
|||
|-|-|
|1|"A"|
|5| #N/A|

### 05.08.03&ensp;VSTACK

### 05.08.04&ensp;TOROW

### 05.08.05&ensp;TOCOL

### 05.08.06&ensp;TRANSPOSE

### 05.08.07&ensp;WRAPCOLS

### 05.08.08&ensp;WRAPROWS

## 05.09&ensp;LAMBDA 函数

> LAMBDA(参数 A,参数 B,参数 C,...表达式)
> 根据传入的参数，执行表达式，返回结果。

1. 在单元格中创建 LAMBDA 函数

```
=LAMBDA(x,y,x*y)(2,3)
结果:6
=LAMBDA(x,y,x*y^2)(2,3)
结果:36
```

2. 在名称管理器中创建 LAMBDA 函数

   - 名称为引用时的函数名
   - 引用为要输入的表达式
     ![](img\05.09_A.png)

```
=Mylambda(1)
结果:2
```

### 05.09.01&ensp;LET

> LET(参数 A,表达式 A,参数 B,表达式 B,参数 C,表达式 C,...表达式)
> 根据传入的参数，执行表达式，返回末尾的表达式。可以参考编程语言中定义变量的方式。

1. 示例 1

```
=LET(x,1,y,2,x+y)
结果:3
```

2. 示例 2

```
=LET(x,2,y,x^2,x*y)
结果:8
```

3. 示例 3

```
=LET(fx,LAMBDA(x,x^2),fx(3))
结果:9
```

### 05.09.02&ensp;MAP

### 05.09.03&ensp;BYROWS

### 05.09.04&ensp;BYCOL

### 05.09.05&ensp;SCAN

### 05.09.06&ensp;REDUCE

### 05.09.07&ensp;MAKEARRAY

### 05.09.08&ensp;GROUPBY

### 05.09.09&ensp;PIVOTBY

[跳转: 06\_\*.md](06_*.md)
[返回: 目录](00_目录.md)
